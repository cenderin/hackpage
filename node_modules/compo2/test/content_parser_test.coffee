[expect, sinon] = require('./test_helper')
ContentParser = require '../src/content_parser.coffee'


describe 'ContentParser', ->

  describe 'parse', ->

    it 'decodes traditional POST data', ->
      result = ContentParser.parse 'one=1&two=2', 'application/x-www-form-urlencoded'
      expect(result).to.eql { one: '1', two: '2' }


    it 'decodes JSON-encoded POST data', ->
      result = ContentParser.parse '{"one":1,"two":2}', 'application/json'
      expect(result).to.eql { one: 1, two: 2 }

    it "doesn't even try to parse if the body is empty", ->
      result = ContentParser.parse '', null
      expect(result).to.eql {}

