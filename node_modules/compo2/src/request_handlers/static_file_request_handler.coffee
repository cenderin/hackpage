LazyLoadingRequestHandler = require './lazy_loading_request_handler.coffee'
fs = require 'fs'


# A request handler for static files.
#
# A static file is one that is not a DOM template, like CSS etc.
# It has no controller logic, and static files have no templating associated with them.
class StaticFileRequestHandler extends LazyLoadingRequestHandler

  # Sets the default metadata for responses.
  get_default_metadata: (path) ->
    # TODO: create the right one here, from the filename.
    result =
      mime_type: 'application/html'
      response_code: 200
    result


  # Processes the given request.
  load_response: (done) ->
    fs.readFile @path, (err, data) ->
      throw "Error: Cannot read static asset file '#{@path}'." if err
      done data


module.exports = StaticFileRequestHandler
